{% extends "base.html" %}
{% block content %}

<div class="container" style="background-color: rgb(255, 255, 255) !important; width: 100% !important; padding-left: 0 !important; padding-right: 0 !important; margin-left: 2px !important; margin-right: 2px !important; margin-top: 0; box-sizing: border-box;">
  <br>
  <div class="row" style="margin-top: 0; padding-top: 0;">
    <div class="col-md-6 classy_frame" style="padding-top: 0%;">
      <center>
        <h3 style="text-transform: capitalize;">Classify the Disease here !</h3>
      </center>
      
      <img id="preview" src="{{ url_for('static', filename='images/sad plant.jpg') }}" height="400px" width="100%"
        title="client pic">

      <center>
        <br>
        <div class="image-upload">
          <p style="color:rgb(17, 45, 14);" id="upload-web">Click the image upload icon below to upload a image.</p
            style="color:wheat;">
          <p style="color:rgb(255, 255, 255);" id="upload-mobile">Click the camera icon below to click a image.</p
            style="color:wheat;">

          <label for="file">
            <img id="upload-web" src="{{ url_for('static', filename = 'images/upload.png') }}" />
            <img id="upload-mobile" src="{{ url_for('static', filename = 'images/camera.png') }}" />

          </label>
          <input type="file" name="file" id="file" onchange="previewImage()">
        </div>

        <br>
        <button class="classify-button" onclick="classifyWaste()">Classify the Plant Disease</button>
      </center>
      <br>
    </div>

    <div class="col-md-6 classy_frame" style="padding-top: 0%;color: rgb(17, 45, 14) !important " id="about">
      <center>
        <h3 style="text-transform: capitalize;">About</h3>
      </center>
      <h4 style="background-color: rgb(255, 255, 255) !important; color: rgb(43, 0, 46) !important ;">In the intricate world of agriculture, the importance of plant disease classification extends far beyond mere categorization; it serves as a beacon of knowledge guiding the sustainable stewardship of our crops.<br><br>

        As we delve into the nuanced realms of plant diseases, the significance becomes apparent. Accurate classification is the first line of defense, enabling early identification and targeted treatment.<br><br>
        
        This process not only safeguards the health of individual plants but also orchestrates a harmonious dance in the delicate balance of ecosystems.<br><br>
        
        By unraveling the mysteries of various diseases through classification, we empower farmers with actionable insights, reducing the reliance on broad-spectrum treatments and promoting environmentally conscious practices.<br><br>
        
        Furthermore, plant disease classification fuels ongoing research, contributing to the collective intelligence that propels agricultural innovation. ðŸŒ±âœ¨</h4>


    </div>
</div>

<div class="row" id="recycling-videos" style="display: none;">
  <br>
  <hr style="height: 20px ; background-color: black; margin: 0;">
  <h3 id="video-title" style="text-align: center; border-top: none; margin-top: 0;">How Clothes Recycling Works?</h3>
  <div class="col-md-6 col-xs-6 classy_frame" style="padding-top: 0%; padding-bottom: 2%;">
    <div class="embed-responsive embed-responsive-16by9">
      <iframe id="video1" width="50" height="50" src="https://www.youtube.com/embed/zO3jFKiqmHo" frameborder="0"
        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope;" allowfullscreen></iframe>
    </div>
  </div>
  <div class="col-md-6 col-xs-6 classy_frame" style="padding-top: 0%; padding-bottom: 2%;">
    <div class="embed-responsive embed-responsive-16by9">
      <iframe id="video2" width="50" height="50" src="https://www.youtube.com/embed/I_fUpP-hq3A" frameborder="0"
        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope;" allowfullscreen></iframe>
    </div>
  </div>
</div>
<hr style="height: 20px ; background-color: black; margin: 0;">




<div class="row" id="govt-schemes">
  <h3 id="govt-ini" style="text-align: center; border-top: none; margin-top: 0;">Checkout the Latest News</h3>
  <div class="col-md-6 col-12 classy_frame" style="padding-top: 0%; padding-bottom: 2%;">
    <center>
      <h2 style="text-transform: capitalize;" id="heading">Initial heading</h2>
    </center>

    <div class="embed-responsive embed-responsive-16by9">
      <iframe id="video" width="560" height="315" src="https://www.youtube.com/embed/qNj8ESmSwcI?si=6EgecneGQRQgLegb"
        title="YouTube video player" frameborder="0"
        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
        allowfullscreen></iframe>
    </div>
  </div>
  <div class="col-md-6 col-12 classy_frame" style="padding-top: 0%; padding-bottom: 2%; text-align: center;">

    <center>
      <h2 style="text-transform: capitalize;">About</h2>
    </center>



    <div class="col-md-12 classy_frame" id="about-section"
      style="text-align: center; padding: 5px 10px !important; font-size: 33px; color: rgb(85, 22, 91) !important; margin-top: 10px;">

      <!-- <h4 style="background-color: rgb(156, 55, 149) !important; color: rgb(85, 22, 91);">The Guidelines on Extended
        Producer Responsibility (EPR) for plastic packaging vide Plastic Waste Management (Amendment) Rules, 2022, on
        16th February 2022. The Guidelines stipulate mandatory targets on EPR, recycling of plastic packaging waste,
        reuse of rigid plastic packaging and use of recycled plastic content.</h4> -->

    </div>
    <button id="left-arrow" class="arrow-button"
      style="background: black; border: solid black; font-size: 24px; cursor: pointer; margin-right: 10px;">&#9664;</button>
    <button id="right-arrow" class="arrow-button"
      style="background: black; border: solid black; font-size: 24px; cursor: pointer; margin-left: auto;">&#9654;</button>
  </div>
</div>


<script>
  var imgData;
  var loading = document.getElementById("loading");
  var govtschemes = document.getElementById("govt-schemes");
  var recyclingvideos = document.getElementById("recycling-videos");
  const heading = document.getElementById('heading');
  const video = document.getElementById('video');
  const aboutSection = document.getElementById('about-section');
  const leftArrow = document.getElementById('left-arrow');
  const rightArrow = document.getElementById('right-arrow');



  const data = [
  {
      heading: 'fungal viruses: why it matters ',
      videoSrc: 'https://www.youtube.com/embed/vijGdWn5-h8?si=0-udSqSBac0RrbZk',
      about: ' fungal viruses can cause tremendous damage, for instance by hitting agricultural outputs. Researchers estimate that such viruses destroy up to 30% of crop products. This has huge implications for food security.'
    },
    {
      heading: 'Trees in South Africa are under attack.',
      videoSrc: 'www.youtube.com/embed/QW61D92WV1I?si=bDCYlUmx_GL01Fvl',
      about: 'South Africa has never had to deal with a tree-killing pest of this importance before. In addition, the country has limited resources and there has been confusion about which government department should take responsibility. '},
    {
      heading: 'Protecting cassava from disease?',
      videoSrc: 'https://www.youtube.com/embed/5SN9bBuH-sg?si=nOC5uhEALEgdcaw5',
      about: 'cassava, like many other crops, is vulnerable to viruses and other plant diseases. These diseases can affect cassava yields, cost farmers money, and threaten food security in sub-Saharan Africa. .  '
    }
  ];

  let currentIndex = 0;

  leftArrow.addEventListener('click', function () {
    currentIndex = (currentIndex - 1 + data.length) % data.length;
    updateContent();
  });

  rightArrow.addEventListener('click', function () {
    currentIndex = (currentIndex + 1) % data.length;
    updateContent();
  });

  function updateContent() {
    const currentData = data[currentIndex];
    heading.textContent = currentData.heading;
    video.src = currentData.videoSrc;
    aboutSection.textContent = currentData.about;
  }

  updateContent();

  govtschemes.style.display = "none";
  recyclingvideos.style.display = "none";










  function previewImage() {

    var file = document.getElementById("file").files;
    if (file.length > 0) {
      var fileName = file[0].name;
      var allowed_extensions = new Array("jpeg", "jpg", "png");
      var file_extension = fileName.split('.').pop().toLowerCase();

      if (allowed_extensions[0] == file_extension || allowed_extensions[1] == file_extension || allowed_extensions[2] == file_extension) {
        var imgObj = document.getElementById("preview");
        var fileReader = new FileReader();

        fileReader.onload = function (event) {
          document.getElementById("preview").setAttribute("src", event.target.result);
          imgData = event.target.result;
        };

        fileReader.readAsDataURL(file[0]);
      }
      else {
        document.getElementById("file").value = "";
        document.getElementById("errorTitle").innerHTML = "Error - Only Image File Acceptable";
        document.getElementById("errorMessage").innerHTML = "We only accept image with .jpeg .jpg or .png extensions.";
        $("#errorPopup").modal("show");

      }


    }
  }

  function classifyWaste() {
    var file = document.getElementById("file").files;
    if (file.length > 0) {
      loading.style.display = "block";
      govtschemes.style.display = "block";
      recyclingvideos.style.display = "block";

      var form_data = new FormData();
      form_data.append("file", document.getElementById("file").files[0]);
      $.ajax({
        url: 'classifywaste', // point to server-side URL
        dataType: 'json', // what to expect back from server
        cache: false,
        contentType: false,
        processData: false,
        data: form_data,
        type: 'post',
        success: function (data) {

          var predicted_value = data["predicted_value"];
          var details = data["details"];
          var video1 = data["video1"];
          var video2 = data["video2"];

          var about = document.getElementById("about");
          var videotitle = document.getElementById("video-title");

          about.innerHTML = "<center><h3>Type - <b>" + predicted_value + "</b></h3></center><h4>" + details + "</h4>";
          videotitle.innerHTML = "More about " + predicted_value ;

          document.getElementById("video1").setAttribute("src", "https://www.youtube.com/embed/" + video1);
          document.getElementById("video2").setAttribute("src", "https://www.youtube.com/embed/" + video2);

          loading.style.display = "none";
        }

      });
    }
    else {
      document.getElementById("errorTitle").innerHTML = "Error - Upload an Image Please!";
      document.getElementById("errorMessage").innerHTML = "Please upload image of the plant .";
      $("#errorPopup").modal("show");
    }
  }
</script>


{% endblock %}